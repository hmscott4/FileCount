<ManagementPackFragment SchemaVersion="2.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Monitoring>
    <Rules>
      <Rule ID="Network.FileCount.Share.Monitoring.PSScript.Rule.CollectFileCount" Enabled="true" Target="Network.FileCount.Share" ConfirmDelivery="true" Remotable="false" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DataSource" TypeID="Network.FileCount.DataSource" RunAs="Network.FileCount.RunasProfile">
            <IntervalSeconds>900</IntervalSeconds>
            <SyncTime></SyncTime>
            <Share>$Target/Property[Type='Network.FileCount.Share']/Share$</Share>
            <Extension>$Target/Property[Type='Network.FileCount.Share']/Extension$</Extension>
            <Count>$Target/Property[Type='Network.FileCount.Share']/Count$</Count>
            <Age>$Target/Property[Type='Network.FileCount.Share']/Age$</Age>
            <Recurse>$Target/Property[Type='Network.FileCount.Share']/Recurse$</Recurse>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="MapToPerf" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>$Target/Host/Host/Property[Type='Windows!Microsoft.Windows.Computer']/PrincipalName$</ObjectName>
          <CounterName>File Count</CounterName>
          <InstanceName>$Target/Property[Type='Network.FileCount.Share']/Share$</InstanceName>
          <Value>$Data/Property[@Name='Files']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDBLicenses" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="PublishLicenses" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
    </Rules>    
  </Monitoring>
</ManagementPackFragment>
